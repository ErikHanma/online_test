{% extends 'myapp/base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'myapp/css/profile.css' %}">
{% endblock %}

{% block content %}
<div class="container">
    <div class="profile-header">
        <div class="profile-avatar">
            {{ user.first_name.0|upper }}{{ user.last_name.0|upper }}
        </div>
        <h1 class="profile-name">{{ user.first_name }} {{ user.last_name }}</h1>
        <p class="profile-email">{{ user.email }}</p>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon">üìä</div>
            <span class="stat-value">{{ stats.total_tests }}</span>
            <span class="stat-label">–ü—Ä–æ–π–¥–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤</span>
        </div>
        <div class="stat-card">
            <div class="stat-icon">üìà</div>
            <span class="stat-value">{{ stats.avg_score }}%</span>
            <span class="stat-label">–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª</span>
        </div>
        <div class="stat-card">
            <div class="stat-icon">üèÜ</div>
            <span class="stat-value">{{ stats.best_score }}%</span>
            <span class="stat-label">–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</span>
        </div>
    </div>

    <h2 class="section-title">
        üìù –ò—Å—Ç–æ—Ä–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–π
    </h2>

    {% if results %}
        <div class="results-list">
            {% for result in results %}
            <div class="result-item">
                <div class="result-icon">
                    {% if result.percentage_score >= 80 %}üéâ
                    {% elif result.percentage_score >= 60 %}üëç
                    {% elif result.percentage_score >= 40 %}üìö
                    {% else %}üí™
                    {% endif %}
                </div>
                
                <div class="result-info">
                    <h3>{{ result.test.title }}</h3>
                    <div class="result-meta">
                        <span>{{ result.timestamp|date:"d.m.Y H:i" }}</span>
                        <span>‚Ä¢</span>
                        <span>{{ result.score }} –∏–∑ {{ result.total_questions }}</span>
                    </div>
                </div>
                
                <div class="result-score">
                    <div class="score-badge 
                        {% if result.percentage_score >= 80 %}score-excellent
                        {% elif result.percentage_score >= 60 %}score-good
                        {% elif result.percentage_score >= 40 %}score-average
                        {% else %}score-poor
                        {% endif %}">
                        {{ result.percentage_score|floatformat:0 }}%
                    </div>
                    <div class="result-date">
                        {{ result.time_spent_minutes }} –º–∏–Ω
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-state">
            <div class="empty-state-icon">üìã</div>
            <h3>–í—ã –µ—â–µ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ —Ç–µ—Å—Ç—ã</h3>
            <p>–ù–∞—á–Ω–∏—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å–≤–æ–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–¥–µ—Å—å</p>
            <a href="{% url 'test_list' %}" class="btn btn-primary">
                –ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç–µ—Å—Ç–∞–º
            </a>
        </div>
    {% endif %}
</div>
{% endblock %}